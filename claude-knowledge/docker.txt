# TUBECRAFT Claude Code é–‹ç™ºã‚¬ã‚¤ãƒ‰

## ğŸš€ é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶
- Docker Desktop ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- VS Code + Claude Code æ‹¡å¼µæ©Ÿèƒ½
- Gitï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

## ğŸ“ æ¨å¥¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```bash
TUBECRAFT/
â”œâ”€â”€ claude-knowledge/        # æ—¢å­˜ï¼ˆä»•æ§˜æ›¸ç­‰ï¼‰
â”œâ”€â”€ docker/                 # Dockeré–¢é€£
â”‚   â”œâ”€â”€ generator/
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â””â”€â”€ requirements.txt
â”‚   â”œâ”€â”€ manager/
â”‚   â”‚   â””â”€â”€ Dockerfile
â”‚   â””â”€â”€ docker-compose.yml
â”œâ”€â”€ src/                    # ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ generator/
â”‚   â”œâ”€â”€ manager/
â”‚   â””â”€â”€ common/
â”œâ”€â”€ scripts/               # å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ setup.sh
â”‚   â”œâ”€â”€ start.sh
â”‚   â””â”€â”€ stop.sh
â”œâ”€â”€ config/               # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ .env.example
â”œâ”€â”€ data/                 # ãƒ‡ãƒ¼ã‚¿ä¿å­˜ç”¨
â”‚   â”œâ”€â”€ audio/
â”‚   â”œâ”€â”€ video/
â”‚   â””â”€â”€ metadata/
â””â”€â”€ README.md
```

## ğŸ”§ Claude Codeã§ã®ä½œæ¥­æ‰‹é †

### Step 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
#!/bin/bash
# scripts/init-project.sh

echo "ğŸš€ TUBECRAFT ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–é–‹å§‹..."

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
directories=(
    "docker/generator"
    "docker/manager"
    "src/generator"
    "src/manager"
    "src/common"
    "scripts"
    "config"
    "data/audio"
    "data/video"
    "data/metadata"
    "tests"
    "docs"
)

for dir in "${directories[@]}"; do
    mkdir -p "$dir"
    echo "âœ… Created: $dir"
done

# .gitignoreä½œæˆ
cat > .gitignore << 'EOF'
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
env/
venv/
.env

# Docker
*.log
docker-compose.override.yml

# Data
data/audio/*
data/video/*
data/metadata/*
!data/audio/.gitkeep
!data/video/.gitkeep
!data/metadata/.gitkeep

# IDE
.vscode/
.idea/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db
EOF

# .gitkeepãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
touch data/audio/.gitkeep
touch data/video/.gitkeep
touch data/metadata/.gitkeep

echo "âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®åˆæœŸåŒ–å®Œäº†ï¼"
```

### Step 2: Dockerè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

#### 2.1 ãƒ¡ã‚¤ãƒ³ã®docker-compose.yml

```yaml
# docker/docker-compose.yml
version: '3.8'

services:
  # n8n ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³
  n8n:
    image: n8nio/n8n:latest
    container_name: tubecraft-n8n
    restart: unless-stopped
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=${N8N_USER:-admin}
      - N8N_BASIC_AUTH_PASSWORD=${N8N_PASSWORD:-tubecraft2024}
      - N8N_HOST=0.0.0.0
      - N8N_PORT=5678
      - N8N_PROTOCOL=http
      - NODE_ENV=production
      - WEBHOOK_URL=http://n8n:5678/
    ports:
      - "5678:5678"
    volumes:
      - n8n_data:/home/node/.n8n
      - ../data:/data
    networks:
      - tubecraft-network
    depends_on:
      - postgres

  # PostgreSQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
  postgres:
    image: postgres:15-alpine
    container_name: tubecraft-postgres
    restart: unless-stopped
    environment:
      - POSTGRES_USER=${POSTGRES_USER:-tubecraft}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-tubecraft2024}
      - POSTGRES_DB=${POSTGRES_DB:-tubecraft_db}
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init-db.sql:/docker-entrypoint-initdb.d/init.sql
    networks:
      - tubecraft-network
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER:-tubecraft}"]
      interval: 10s
      timeout: 5s
      retries: 5

  # Ollama (LLM)
  ollama:
    image: ollama/ollama:latest
    container_name: tubecraft-ollama
    restart: unless-stopped
    ports:
      - "11434:11434"
    volumes:
      - ollama_data:/root/.ollama
    networks:
      - tubecraft-network
    deploy:
      resources:
        limits:
          memory: 8G
    # GPUã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤–ã™
    # runtime: nvidia
    # environment:
    #   - NVIDIA_VISIBLE_DEVICES=all

  # ã‚«ã‚¹ã‚¿ãƒ ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹
  generator:
    build:
      context: ./generator
      dockerfile: Dockerfile
    container_name: tubecraft-generator
    restart: unless-stopped
    environment:
      - OLLAMA_HOST=http://ollama:11434
      - POSTGRES_HOST=postgres
      - POSTGRES_USER=${POSTGRES_USER:-tubecraft}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-tubecraft2024}
      - POSTGRES_DB=${POSTGRES_DB:-tubecraft_db}
    volumes:
      - ../src/generator:/app
      - ../data:/data
    networks:
      - tubecraft-network
    depends_on:
      - ollama
      - postgres

volumes:
  n8n_data:
  postgres_data:
  ollama_data:

networks:
  tubecraft-network:
    driver: bridge
```

#### 2.2 ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```bash
# config/.env.example
# Database
POSTGRES_USER=tubecraft
POSTGRES_PASSWORD=tubecraft2024
POSTGRES_DB=tubecraft_db

# n8n
N8N_USER=admin
N8N_PASSWORD=tubecraft2024

# Ollama
OLLAMA_MODEL=mistral:7b

# Generator Settings
VIDEO_QUALITY=high
AUDIO_SAMPLE_RATE=44100
MAX_CONCURRENT_JOBS=3

# Storage
DATA_PATH=/data
BACKUP_PATH=/backup
```

### Step 3: å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ

#### 3.1 ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
#!/bin/bash
# scripts/setup.sh

set -e

echo "ğŸ”§ TUBECRAFT ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—é–‹å§‹..."

# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ”ãƒ¼
if [ ! -f ../config/.env ]; then
    cp ../config/.env.example ../config/.env
    echo "âœ… .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ"
fi

# Docker ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä½œæˆ
docker network create tubecraft-network 2>/dev/null || true

# Ollama ãƒ¢ãƒ‡ãƒ«ã®ãƒ—ãƒ«
echo "ğŸ“¥ Mistral 7B ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­..."
docker run --rm -v ollama_data:/root/.ollama ollama/ollama pull mistral:7b

echo "âœ… ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ï¼"
```

#### 3.2 èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
#!/bin/bash
# scripts/start.sh

cd ../docker

echo "ğŸš€ TUBECRAFT ã‚’èµ·å‹•ä¸­..."

# Docker Compose èµ·å‹•
docker-compose up -d

# èµ·å‹•ç¢ºèª
echo "â³ ã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•ã‚’å¾…æ©Ÿä¸­..."
sleep 20

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
services=("n8n" "postgres" "ollama")
for service in "${services[@]}"; do
    if docker-compose ps | grep -q "tubecraft-$service.*Up"; then
        echo "âœ… $service: èµ·å‹•æˆåŠŸ"
    else
        echo "âŒ $service: èµ·å‹•å¤±æ•—"
    fi
done

echo ""
echo "ğŸ“‹ ã‚¢ã‚¯ã‚»ã‚¹æƒ…å ±:"
echo "- n8n: http://localhost:5678"
echo "- ãƒ¦ãƒ¼ã‚¶ãƒ¼: admin"
echo "- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: tubecraft2024"
```

### Step 4: åˆæœŸå®Ÿè£…ï¼ˆgenerator/Dockerfileï¼‰

```dockerfile
# docker/generator/Dockerfile
FROM python:3.10-slim

WORKDIR /app

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
RUN apt-get update && apt-get install -y \
    ffmpeg \
    git \
    && rm -rf /var/lib/apt/lists/*

# Python ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰
COPY . .

CMD ["python", "-m", "uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
```

```txt
# docker/generator/requirements.txt
fastapi==0.104.1
uvicorn==0.24.0
httpx==0.25.1
pydantic==2.5.0
sqlalchemy==2.0.23
asyncpg==0.29.0
moviepy==1.0.3
Pillow==10.1.0
```

## ğŸ”„ Claude Codeã§ã®é–‹ç™ºãƒ•ãƒ­ãƒ¼

### 1. åˆæœŸãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆï¼ˆClaude Codeå®Ÿè¡Œï¼‰
```bash
# Claude Codeã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¦ã‚‚ã‚‰ã†
cd /Users/matthew/Documents/GitHub/vs-code-active/TUBECRAFT
bash scripts/init-project.sh
```

### 2. Dockerèµ·å‹•ï¼ˆã‚ãªãŸãŒå®Ÿè¡Œï¼‰
```bash
cd scripts
bash setup.sh
bash start.sh
```

### 3. ã‚¨ãƒ©ãƒ¼ç¢ºèªãƒ»ä¿®æ­£ï¼ˆClaude Codeå®Ÿè¡Œï¼‰
```bash
# ãƒ­ã‚°ç¢ºèª
docker-compose logs -f

# ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Œã°ã€Claude Codeã§ä¿®æ­£
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

1. **ãƒãƒ¼ãƒˆç«¶åˆ**
   ```bash
   # ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆç¢ºèª
   lsof -i :5678
   # docker-compose.ymlã§ãƒãƒ¼ãƒˆå¤‰æ›´
   ```

2. **ãƒ¡ãƒ¢ãƒªä¸è¶³**
   ```yaml
   # Docker Desktopè¨­å®šã§å¢—ã‚„ã™
   # ã¾ãŸã¯ docker-compose.yml ã§åˆ¶é™
   deploy:
     resources:
       limits:
         memory: 4G
   ```

3. **æ¨©é™ã‚¨ãƒ©ãƒ¼**
   ```bash
   # ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™
   chmod -R 777 data/
   ```

## ğŸ“ Gité€£æºï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### GitHub ãƒªãƒã‚¸ãƒˆãƒªä½œæˆå¾Œ
```bash
git init
git add .
git commit -m "Initial commit: TUBECRAFT setup"
git branch -M main
git remote add origin https://github.com/YOUR_USERNAME/tubecraft.git
git push -u origin main
```

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **åŸºæœ¬å‹•ä½œç¢ºèª**
   - n8nã«ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆhttp://localhost:5678ï¼‰
   - ç°¡å˜ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä½œæˆ

2. **æ©Ÿèƒ½å®Ÿè£…**
   - Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆé–‹ç™º
   - n8nãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ
   - APIå®Ÿè£…

3. **ãƒ†ã‚¹ãƒˆãƒ»æœ€é©åŒ–**
   - å‹•ç”»ç”Ÿæˆãƒ†ã‚¹ãƒˆ
   - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹èª¿æ•´
